---
dist: trusty
language: python
python: "2.7"

sudo: true

env:
  - distribution: ubuntu
    distribution_version: 16
  - distribution: ubuntu
    distribution_version: 14

before_install:
  - sudo apt-get -qq update

install:
  # Create a random file to store the container ID.
  - container_id=$(mktemp)

  # Download test script.
  - wget -O ${PWD}/tests/test.sh https://gist.githubusercontent.com/Nani-o/ce936e8966a020769cf696eaa0f69a76/raw/
  - chmod +x ${PWD}/tests/test.sh

script:
  # Run tests.
  - ${PWD}/tests/test.sh

after_failure:
  - echo '# ip machine'
  - /sbin/ip a
  - echo '# ip c1'
  - sudo -E su travis -c "lxc exec c1 /sbin/ip a"
  - echo '# list container containers'
  - sudo -E su travis -c "lxc list"
